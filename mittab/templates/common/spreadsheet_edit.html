{% extends "base/__wide.html" %}
{% block title %}{{ title }}{% endblock %}
{% block banner %}{{ title }}{% endblock %}
{% block content %}
<div class="col-lg-12" id="spreadsheet-wrapper" data-allow-create="{{ allow_create|yesno:'true,false' }}">
  <div class="spreadsheet-toolbar">
    <div class="spreadsheet-actions">
      {% if allow_create %}
      <button class="btn btn-outline-primary btn-sm" id="add-row-btn">Add Row</button>
      {% endif %}
      <button class="btn btn-primary btn-sm" id="save-spreadsheet">Save Changes</button>
    </div>
    <div class="ms-auto">
      <small class="text-muted">Paste, sort, drag-fill, and edit cells directly. Locked headers match database fields.</small>
    </div>
  </div>
  <div id="spreadsheet-status" class="alert" role="status"></div>
  <div id="spreadsheet-table" class="spreadsheet-table"></div>
</div>

{{ columns|json_script:"spreadsheet-columns" }}
{{ data|json_script:"spreadsheet-data" }}
{% endblock %}
