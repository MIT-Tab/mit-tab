{% extends "base/__wide.html" %}
{% load tags %}
{% load render_bundle from webpack_loader %}

{% block title %}{% tournament_name %}{% endblock %}

{% block extra_head %}
  {% render_bundle 'publicHome' %}
  {% render_bundle 'publicDisplay' %}
{% endblock %}

{% block banner %}{% endblock %}

{% block content %}
<div class="col-12 d-flex justify-content-center public-home-wrapper">
  <div class="public-home"
       data-public-home
       data-cur-round="{{ cur_round }}"
       data-total-rounds="{{ tot_rounds }}"
       data-pairing-released="{{ pairing_released|yesno:'true,false' }}"
       data-in-outrounds="{{ in_outrounds|yesno:'true,false' }}"
       data-current-outround-label="{{ current_outround_label|escape }}">
    <div class="grid">
      <aside class="sidebar">
        <div class="public-sidebar-card status">
          <h3 class="title">Welcome to {% tournament_name %}!</h3>
          <div class="content">
            {% if not registration_open %}
            <div class="status-block" data-status>
              <div class="status-icon" aria-hidden="true" data-status-icon>
                <i class="fas fa-clipboard-check"></i>
              </div>
              <div class="status-text" aria-live="polite">
                <div class="status-primary" data-status-primary>{{ status_primary }}</div>
                <div class="status-secondary" data-status-secondary>{{ status_secondary }}</div>
              </div>
            </div>
            <div class="divider"></div>
            <div class="item">
              <div class="text">
                <strong>Tournament Updates</strong>
                <p>Check back regularly for updated pairings, results, and standings throughout the tournament.</p>
              </div>
            </div>
            <div class="item">
              <div class="text">
                <strong>For Judges</strong>
                <p>Use your ballot code to submit results electronically via the E-Ballot link.</p>
              </div>
            </div>
            <div class="item">
              <div class="text">
                <strong>For Teams</strong>
                <p>View your matchups in Released Pairings and track your progress in Team Rankings.</p>
              </div>
            </div>
            <div class="item">
              <div class="text">
                <strong>Staff Login</strong>
                <p><a href="{% url 'tab_login' %}">Login here</a> if you're tournament staff to access admin features.</p>
              </div>
            </div>
            {% else %}
            <div class="registration-panel">
              <div class="registration-panel__header">
                <h4>Registration Open</h4>
              </div>
              <div class="registration-panel__text">
                {% if registration_description %}
                  {{ registration_description|registration_text }}
                {% else %}
                  Registration is live! Please review the information below and complete the form to reserve your schoolâ€™s slots.
                {% endif %}
              </div>
              <a class="btn btn-primary btn-block mt-3" href="{{ registration_url }}">Register Now</a>
            </div>
            {% endif %}
          </div>
        </div>
      </aside>
      
      <aside class="links" aria-labelledby="public-home-quick-links">
        <header class="header mobile-only">
          <h1 class="title" id="public-home-quick-links">Welcome to {% tournament_name %}!</h1>
          {% if registration_open %}
          <a class="btn btn-primary btn-lg btn-block registration-mobile-cta" href="{{ registration_url }}">Register Here</a>
          <div class="registration-mobile-card">
            <div class="registration-mobile-card__text">
              {% if registration_description %}
                {{ registration_description|registration_text }}
              {% else %}
                Registration is now open. Complete the form to add teams and judges for your school.
              {% endif %}
            </div>
          </div>
          {% else %}
          <h2 class="status-title mb-2">Status:</h2>
          <div class="status-block status-block--inline" data-status>
            <div class="status-icon" aria-hidden="true" data-status-icon>
              <i class="fas fa-clipboard-check"></i>
            </div>
            <span class="status-divider" aria-hidden="true"></span>
            <div class="status-text" aria-live="polite">
              <div class="status-primary" data-status-primary>{{ status_primary }}</div>
              <div class="status-secondary" data-status-secondary>{{ status_secondary }}</div>
            </div>
          </div>
          {% endif %}
        </header>

        {% if registration_open %}
        <div class="register-cta d-none d-lg-flex">
          <div class="register-cta__text">
            <span class="eyebrow">Registration Open</span>
            <span class="headline">Reserve your slots today.</span>
            <p class="body">Lock in your teams and judging obligations before pairings post.</p>
          </div>
          <a class="btn btn-primary btn-lg register-cta__btn" href="{{ registration_url }}">Register Here</a>
        </div>
        {% endif %}

        <nav class="public-links" aria-label="Quick links">
          {% if not registration_open %}
          <a class="tile shadow-sm" href="{% url 'pretty_pair' %}">
            <span class="body">
              <span class="title">Released Pairings</span>
              <span class="subtitle">Latest rounds and room assignments.</span>
            </span>
            <span class="chevron"><i class="fas fa-arrow-right"></i></span>
          </a>
          <a class="tile shadow-sm" href="{% url 'missing_ballots' %}">
            <span class="body">
              <span class="title">Missing Ballots</span>
              <span class="subtitle">Outstanding ballots that need attention.</span>
            </span>
            <span class="chevron"><i class="fas fa-arrow-right"></i></span>
          </a>
          <a class="tile shadow-sm" href="{% url 'e_ballot_search' %}">
            <span class="body">
              <span class="title">Submit E-Ballot</span>
              <span class="subtitle">Judges enter ballot codes to file results.</span>
            </span>
            <span class="chevron"><i class="fas fa-arrow-right"></i></span>
          </a>
          {% endif %}
          <a class="tile shadow-sm" href="{% url 'public_judges' %}">
            <span class="body">
              <span class="title">Judge List</span>
              <span class="subtitle">Roster and check-in status.</span>
            </span>
            <span class="chevron"><i class="fas fa-arrow-right"></i></span>
          </a>
          <a class="tile shadow-sm" href="{% url 'public_teams' %}">
            <span class="body">
              <span class="title">Team List</span>
              <span class="subtitle">Registered teams and schools.</span>
            </span>
            <span class="chevron"><i class="fas fa-arrow-right"></i></span>
          </a>
          {% if not registration_open %}
          <a class="tile shadow-sm" href="{% url 'outround_pretty_pair' 0 %}">
            <span class="body">
              <span class="title">Varsity Outrounds</span>
              <span class="subtitle">Varsity elimination brackets and pairings.</span>
            </span>
            <span class="chevron"><i class="fas fa-arrow-right"></i></span>
          </a>
          <a class="tile shadow-sm" href="{% url 'outround_pretty_pair' 1 %}">
            <span class="body">
              <span class="title">Novice Outrounds</span>
              <span class="subtitle">Novice elimination brackets and pairings.</span>
            </span>
            <span class="chevron"><i class="fas fa-arrow-right"></i></span>
          </a>
          {% endif %}
        </nav>
      </aside>
    </div>
  </div>
</div>

{% endblock %}
