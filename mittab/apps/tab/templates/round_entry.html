{% extends "base.html" %}
{% load widget_tweaks %}

{% block title %}Data Entry{% endblock %}

{% block banner %} {{title}} {% endblock %}

{% block content %}
<div class="container-fluid">
  {% if form.errors %}
    <p style="color: red;">
      Please correct the error{{ form.errors|pluralize }} below.
    </p>
  {% endif %}

  <script type="text/javascript" src="/dynamic-media/jsi18n/"></script>

  {{ form.media }}

  <form action="{{ action }}" method="post" class="form-control dataEntryForm" enctype="multipart/form-data">{% csrf_token %}
    {{ form.non_field_errors }}

    {# Include the hidden fields #}
    {% for hidden in form.hidden_fields %}
      {{ hidden }}
    {% endfor %}

    <div class="row">
      <div class="col-12">
        {{ form.winner.errors }}
        <div class="form-group col-4">
          {{ form.winner.label_tag }}
          {% render_field form.winner class="form-control" %}
        </div>

        <div></div>
        <div></div>
        <div class="col-4">
          <div class="hidden winner" data-option=0>Please select a winner</div>
          <div class="hidden winner alert alert-info" data-option=1>
              The Government team has won.  Enter speaks and ranks
              normally.
          </div>
          <div class="hidden winner alert alert-info" data-option=2>
              The Opposition team has won. Enter speaks and ranks
              normally
          </div>
          <div class="hidden winner alert alert-info" data-option=3>
              The Government team has won via forfeit. Enter speaks of
              zero and arbitrary ranks for all debaters. The winning team
              will receive average speaks and ranks for this round. 
              The losing team will receive speaks of zero and ranks of 7,
              although you can give them non zero speaks if you wish.
              Do <b>not</b> give speaks to the winning team.
          </div>
          <div class="hidden winner alert alert-info" data-option=4>
              The Opposition team has won via forfeit. Enter speaks of
              zero and arbitrary ranks for all debaters. The winning team
              will receive average speaks and ranks for this round. 
              The losing team will receive speaks of zero and ranks of 7,
              although you can give them non zero speaks if you wish.
              Do <b>not</b> give speaks to the winning team.
          </div>
          <div class="hidden winner alert alert-info" data-option=5>
              Everyone lost this round (didn't show up?). Enter speaks of
              zero and arbitrary ranks. Both teams will receive speaks of
              zero and ranks of 7, although you can give them non zero
              speaks if you wish.  No averaging will occur, however.
          </div>
          <div class="hidden winner alert alert-info" data-option=6>
              Everyone won this round (judge didn't show up). Enter speaks
              of zero and arbitrary ranks. Both teams will receive average
              speaks and ranks for this round. Do <b>not</b> give speaks
              greater than zero to either team.
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-6 border-right p-4">
        <center>
          <h4 class="header">Government: {{gov_team.name}}</h4>
        </center>

        <div class="gov">
          <div class="pm row pb-1 border-bottom">
            <div class="col-12 form-group">
              {{ form.pm_debater.errors }}
              <label for="id_pm_debater">Prime Minister</label>
              <div>
                {% render_field form.pm_debater class="form-control" %}
              </div>
            </div>

            <div class="speaks col-6 form-group">
              {{ form.pm_speaks.errors }}
              <label for="id_pm_speaks">Speaks</label>
              <div>{% render_field form.pm_speaks class="form-control" %}</div>
            </div>

            <div class="ranks col-6 form-group">
              {{ form.pm_ranks.errors }}
              <label for="id_pm_ranks">Ranks</label>
              <div>{% render_field form.pm_ranks class="form-control" %}</div>
            </div>
          </div>

          <div class="mg row pt-1">
            <div class="col-12 form-group">
              {{ form.mg_debater.errors }}
              <label for="id_mg_debater">Member of Government</label>
              <div>{% render_field form.mg_debater class="form-control" %}</div>
            </div>

            <div class="speaks col-6 form-group">
              {{ form.mg_speaks.errors }}
              <label for="id_mg_speaks">Speaks</label>
              <div>{% render_field form.mg_speaks class="form-control" %}</div>
            </div>

            <div class="ranks col-6 form-group">
              {{ form.mg_ranks.errors }}
              <label for="id_mg_ranks">Ranks</label>
              <div>{% render_field form.mg_ranks class="form-control" %}</div>
            </div>
          </div>
        </div>

      </div>

      <div class="col-6 p-4">
        <center>
          <h4 class="header">Opposition: {{opp_team.name}}</h4>
        </center>

        <div class="opp">
          <div class="lo row pb-1 border-bottom">
            <div class="col-12 form-group">
              {{ form.lo_debater.errors }}
              <label for="id_lo_debater">Leader of Opposition</label>
              <div>{% render_field form.lo_debater class="form-control" %}</div>
            </div>

            <div class="speaks col-6 form-group">
              {{ form.lo_speaks.errors }}
              <label for="id_pm_speaks">Speaks</label>
              <div>{% render_field form.lo_speaks class="form-control" %}</div>
            </div>

            <div class="ranks col-6 form-group">
              {{ form.lo_ranks.errors }}
              <label for="id_lo_ranks">Ranks</label>
              <div>{% render_field form.lo_ranks class="form-control" %}</div>
            </div>
          </div>

          <div class="mo row pt-1">
            <div class="col-12 form-group">
              {{ form.mo_debater.errors }}
              <label for="id_mo_debater">Member of Opposition</label>
              <div>{% render_field form.mo_debater class="form-control" %}</div>
            </div>

            <div class="speaks col-6 form-group">
              {{ form.mo_speaks.errors }}
              <label for="id_mo_speaks">Speaks</label>
              <div>{% render_field form.mo_speaks class="form-control" %}</div>
            </div>

            <div class="ranks col-6 form-group">
              {{ form.mo_ranks.errors }}
              <label for="id_mo_ranks">Ranks</label>
              <div>{% render_field form.mo_ranks class="form-control" %}</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    {% if form.ballot_code %}
    <div class="row">
      {{ form.ballot_code.errors }}
      <label for="id_ballot_code">Ballot code</label>
      <div>{% render_field form.ballot_code class="form-control" %}</div>
    </div>
    {% endif %}

    {% if links %}
    <div class="btn-group">
      {% for link,text,confirm in links %}
        <a class="mid btn {%if confirm%}confirmLink{%endif%}" href='{{link}}'>{{text}}</a>
      {% endfor %}
    </div>
    {%endif%}

    <div>
      <input class="btn btn-primary" type="submit" value="Submit Changes">
    </div>
  </form>
</div>

{% endblock %}
